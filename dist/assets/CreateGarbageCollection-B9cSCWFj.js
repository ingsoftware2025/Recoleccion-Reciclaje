import{z as s,d as p,i as x,j as r,S as d,u as f,a as j,y as m,b}from"./index-BFoY33C2.js";import{S as g}from"./ShowErrorAPI-C3w4PqSb.js";import{u as S}from"./useQuery-BJEY7UEE.js";import{G as y}from"./AddressAPI-Bb8QZHCp.js";import{E as h,I as _}from"./InputComponent-lP4p_1p_.js";import{I as v}from"./InputSelectSearchComponent-C4FVhnHb.js";const C=s.object({address_id:s.string(),status_id:s.number(),collector_id:s.string(),fecha_recoleccion:s.date()});s.object({data:s.array(C)});async function E(i){var o,t;try{const a="/api/garbage-collection-requests",{data:c}=await p.post(a,i);return c}catch(a){if(x(a))throw new Error(Object.values(((t=(o=a.response)==null?void 0:o.data)==null?void 0:t.errors)||{}).flat().join(`
`))}}function w({register:i,errors:o,control:t}){var l,u;const{data:a=[],isLoading:c}=S({queryKey:["address"],queryFn:y}),n=a.map(e=>({label:`${e.calle}, ${e.numero}, ${e.colonia}, ${e.ciudad} (CP: ${e.codigo_postal})`,value:e.id}));return c?r.jsx(d,{}):r.jsxs("div",{children:[r.jsxs(v,{label:"Direcci贸n",id:"address_id",name:"address_id",options:n,control:t,rules:{required:"La direcci贸n es obligatoria"},errors:o,children:[n.map(e=>r.jsx("option",{value:e.value,children:e.label},e.value)),r.jsx(h,{children:(l=o.address_id)==null?void 0:l.message})]}),r.jsx(_,{label:"Fecha de recolecci贸n",id:"fecha_recoleccion",name:"fecha_recoleccion",type:"date",placeholder:"Fecha de recolecci贸n",register:i,children:r.jsx(h,{children:(u=o.fecha_recoleccion)==null?void 0:u.message})})]})}function G(){const i=f(),{mutate:o,isPending:t,isError:a}=j({mutationFn:E,onError:e=>{m.error(e.message)},onSuccess:e=>{m.success(e),i("/collection")}}),{register:c,handleSubmit:n,control:l,formState:{errors:u}}=b();return a?r.jsx(g,{}):t?r.jsx(d,{}):r.jsxs("div",{children:[r.jsx("h2",{className:"text-4xl font-bold",children:"Solicitar recoleccion de basura"}),r.jsxs("form",{className:"mt-10 w-3/4 mx-auto shadow-xl p-10 space-y-5 my-5",onSubmit:n(e=>o(e)),children:[r.jsx(w,{register:c,errors:u,control:l}),r.jsx("button",{className:"button bg-indigo-500 hover:bg-indigo-600 w-full",children:t?r.jsx(d,{}):r.jsx("p",{children:"Crear Solicitud"})})]})]})}export{G as default};
