import{c as C,r as N,j as e,C as S,S as j,u as E,a as w,b as I,y}from"./index-BFoY33C2.js";import{c as P}from"./UsersAPI-2ZhAduZd.js";import{I as g,E as h}from"./InputComponent-lP4p_1p_.js";import{S as $,I as k}from"./InputSelectSearchComponent-C4FVhnHb.js";import{u as v}from"./useQuery-BJEY7UEE.js";import{g as q}from"./RolesAPI-DfPrKsVJ.js";import{G as F}from"./AddressAPI-Bb8QZHCp.js";import{S as M}from"./ShowErrorAPI-C3w4PqSb.js";/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],U=C("eye-off",_);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],O=C("eye",A);function z({label:r,id:a,name:l,placeholder:i="",register:d,validation:u={},errors:o,children:m}){const[s,p]=N.useState(!1),n=()=>p(!s);return e.jsxs("div",{className:"flex flex-col gap-2 relative",children:[e.jsx("label",{className:"text-lg font-bold uppercase text-gray-700",htmlFor:a,children:r}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{autoComplete:"off",id:a,type:s?"text":"password",placeholder:i,className:`border border-gray-300 rounded-sm p-3 pr-10 text-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-all duration-300 ease-in-out hover:border-indigo-400 w-full ${o!=null&&o[l]?"border-red-600 ring-2 ring-red-600":""}`,...d(l,u)}),e.jsx("button",{type:"button",onClick:n,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-indigo-500 focus:outline-none",children:s?e.jsx(U,{size:20}):e.jsx(O,{size:20})})]}),(o==null?void 0:o[l])&&e.jsx("span",{className:"text-red-600 text-sm mt-1",children:m})]})}const L=({label:r,id:a,name:l,options:i,control:d,rules:u={},errors:o,children:m})=>{const s=!!(o!=null&&o[l]),p={control:n=>({...n,borderColor:s?"#dc2626":n.borderColor,boxShadow:s?"0 0 0 2px rgba(220, 38, 38, 0.5)":n.boxShadow,"&:hover":{borderColor:s?"#dc2626":"#6366f1"}})};return e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"text-lg font-bold uppercase block mb-1 text-gray-700",htmlFor:a,children:r}),e.jsx(S,{name:l,control:d,rules:u,render:({field:n})=>e.jsx($,{...n,inputId:a,options:i,isMulti:!0,placeholder:"--SELECCIONE UNA O MÁS OPCIONES--",onChange:x=>{const c=x.map(b=>b.value);n.onChange(c)},value:i.filter(x=>{var c;return(c=n.value)==null?void 0:c.includes(x.value)}),styles:p,className:"react-select-container",classNamePrefix:"react-select"})}),s&&e.jsx("span",{className:"text-red-600 text-sm mt-2 block",children:m})]})};function R({register:r,errors:a,control:l,isEditing:i}){var p,n,x,c,b,f;const{data:d=[],isLoading:u}=v({queryKey:["roles"],queryFn:q}),o=d.map(t=>({label:t.name,value:t.id})),{data:m=[]}=v({queryKey:["addresses"],queryFn:F}),s=m.map(t=>({label:`${t.calle}, ${t.numero}, ${t.colonia}, ${t.ciudad} (CP: ${t.codigo_postal})`,value:t.id}));return u?e.jsx(j,{}):e.jsxs(e.Fragment,{children:[e.jsx(g,{label:"Nombre",id:"name",name:"name",placeholder:"Nombre del usuario",register:r,validation:{required:"El nombre es obligatorio"},errors:a,children:e.jsx(h,{children:(p=a.name)==null?void 0:p.message})}),e.jsx(g,{label:"Usuario",id:"username",name:"username",placeholder:"Nombre de Usuario",register:r,validation:{required:"El username es obligatorio"},errors:a,children:e.jsx(h,{children:(n=a.username)==null?void 0:n.message})}),e.jsx(z,{label:"Contraseña",id:"password",name:"password",placeholder:"Contraseña",register:r,validation:i?{}:{required:"La contraseña es obligatoria"},errors:a,children:e.jsx(h,{children:(x=a.password)==null?void 0:x.message})}),e.jsx(g,{label:"Email",id:"email",name:"email",placeholder:"Ingrese su email",register:r,validation:{pattern:{value:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,message:"El email no es valido"}},errors:a,children:e.jsx(h,{children:(c=a.email)==null?void 0:c.message})}),e.jsxs(k,{label:"Rol",id:"role_id",name:"role_id",options:o,control:l,rules:{required:"El rol es obligatorio"},errors:a,children:[o.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value)),e.jsx(h,{children:(b=a.role_id)==null?void 0:b.message})]}),e.jsx(L,{label:"Dirección",id:"direcciones",name:"direcciones",options:s,control:l,rules:{required:"Debe seleccionar al menos una dirección"},errors:a,children:e.jsx(h,{children:(f=a.direcciones)==null?void 0:f.message})})]})}function T(){const r=E(),{mutate:a,isPending:l,isError:i}=w({mutationFn:P,onError:s=>{y.error(s.message)},onSuccess:s=>{y.success(s),r("/usuarios")}}),{register:d,handleSubmit:u,control:o,formState:{errors:m}}=I();return i?e.jsx(M,{}):l?e.jsx(j,{}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-4xl font-bold",children:"Crear Usuario"}),e.jsxs("form",{className:"mt-10 w-3/4 mx-auto shadow-xl p-10 space-y-5 my-5",onSubmit:u(s=>a(s)),children:[e.jsx(R,{register:d,errors:m,control:o}),e.jsx("button",{className:"button bg-indigo-500 hover:bg-indigo-600 w-full",children:l?e.jsx(j,{}):e.jsx("p",{children:"Crear Usuario"})})]})]})}export{T as default};
